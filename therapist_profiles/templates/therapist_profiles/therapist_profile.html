{% extends "base.html" %}
{% load static %}

{% block title %}
Therapist Profiles
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center mb-4">Therapist Profiles</h1>
    <div class="row">
        <div class="col-md-4">
            <div class="card-deck">
                {% for profile in profiles %}
                <div class="card" style="max-width: 250px;">
                    <!-- Profile Picture -->
                {% if profile.photo %}
                <img src="{{ profile.photo.url }}" class="card-img-top img-fluid rounded" alt="Profile Picture"
                    style="height: 250px; object-fit: cover;">
                {% else %}
                <img src="{% static 'default_profile_picture.jpg' %}" class="card-img-top img-fluid rounded"
                    alt="Default Profile Picture" style="height: 250px; object-fit: cover;">
                {% endif %}
                <div class="card-body">
                    <!-- Therapist Name -->
                    <h5 class="card-title text-center text-primary">{{ profile.user.first_name }}
                        {{ profile.user.last_name }}</h5>
                    <hr>

                    <!-- Bio -->
                    <p><strong>Bio:</strong></p>
                    <p>{{ profile.bio|linebreaks }}</p>

                    <!-- Credentials -->
                    <p><strong>Credentials:</strong></p>
                    <ul>
                        {% for line in profile.credentials.splitlines %}
                        <li>{{ line }}</li>
                        {% endfor %}
                    </ul>

                    <!-- Services Offered -->
                    <p><strong>Services Offered:</strong>
                        {% if profile.services.all %}
                        {% for service in profile.services.all %}
                        <span class="badge bg-secondary">{{ service.name }}</span>
                        {% endfor %}
                        {% else %}
                        No services listed.
                        {% endif %}
                    </p>
                </div>
            </div>

                <!-- Show Edit Profile Button for the Logged-in Therapist -->
                {% if request.user.is_authenticated and request.user == profile.user %}
                <a href="{% url 'therapist_profile' %}?edit=true" class="btn btn-primary mt-3">Edit Profile</a>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
</div>
</div>
{% endblock %}